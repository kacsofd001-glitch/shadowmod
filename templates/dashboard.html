<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Management Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">Shadow-MOD</div>
            <div class="nav-links">
                <span class="user-info">
                    <img src="{{ avatar_url }}" alt="{{ username }}" class="user-avatar">
                    {{ username }}
                </span>
                <a href="/auth/logout" class="logout-btn">Logout</a>
            </div>
        </div>
    </nav>

    <div class="main-container">
        <div class="header">
            <h1>Server Management</h1>
            <p>Select a server to manage</p>
        </div>

        <div class="servers-grid" id="serversGrid">
            <div class="loading">Loading your servers...</div>
        </div>
    </div>

    <script>
        async function loadServers() {
            try {
                const response = await fetch('/api/servers');
                const data = await response.json();
                
                const grid = document.getElementById('serversGrid');
                grid.innerHTML = '';
                
                if (data.servers.length === 0) {
                    grid.innerHTML = '<p class="no-servers">No servers where you are admin</p>';
                    return;
                }
                
                data.servers.forEach(guild_id => {
                    const card = document.createElement('a');
                    card.href = `/dashboard/server/${guild_id}`;
                    card.className = 'server-card';
                    card.innerHTML = `<div class="server-id">${guild_id}</div>`;
                    grid.appendChild(card);
                });
            } catch (error) {
                console.error('Failed to load servers:', error);
                document.getElementById('serversGrid').innerHTML = '<p class="error">Failed to load servers</p>';
            }
        }

        // Load servers on page load
        document.addEventListener('DOMContentLoaded', loadServers);
    </script>
</body>
</html>
